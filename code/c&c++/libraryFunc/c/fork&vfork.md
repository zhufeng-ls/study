# fork 和 vfork
**不同**: \
1. fork 是对进程的完全拷贝, 而 vfork只有进程对内存的数据更改时才进行拷贝，使用写时复制技术。
2. vfork运行时是父进程是阻塞的。
3. vfork 是子进程和父进程共享一块物理空间，且创建一个子进程会阻塞父进程，避免同时操作栈造成混乱。

**用处**: \
尽量避免使用vfork,除非你能确认不会对内存中的数据进行更改,主要原因时vfork是阻塞的。

**僵尸进程**： \
子进程结束后，在内核中还残留着进程Pid、CPU占用时间、进程退出状态，而子进程使用了return或者exit结束后，在主进程结束前， 父进程没有为它收尸。（wait 和 waitpid）

**避免僵尸进程**: \
1. 拦截子进程的退出信号，为其注册回调。
    ```
    signal(SIGCHLD, wait4children); 
    ```
2. 可以在回调函数中使用 waitPid 或 wait进行回收。其中wait是阻塞的，而带 WNOHANG 参数是不阻塞的。
   ```
   waitpid(-1, &status, WNOHANG)
   ```

**返回值**:\ 
子进程返回0，父进程返回子进程的pid，出错返回 -1。


**注意**: \
1. 在 main函数中， vfork创建的子进程不要使用return, 因为return 会释放一些资源，会影响到父进程。
